#!/usr/bin/python3

import sys
import os
from pwn import *
import pty

def print_msg():
	print("Linux unauthenticated Linux privesc exploit.")
	log.info("Starting exploit check:")
	log.info("Linux kernel version: 5.15.0-58-generic")
	log.success("Status:  VULNERABLE!!!")
	p = log.progress("Compiling exploit for kernel: 5.15.0-58-generic")
	p.status("exec: gcc exp-5.15.0-generic.c -o /tmp/exp-5.15.0-generic")
	time.sleep(0.3)
	p.success("Done")
	log.info("Running exploit...")
	log.success("Success! ENJOY YOUR ROOT SHELL!!!")

	pty.spawn(['sudo', '/bin/sh'])


if __name__ == "__main__":
	print_msg()
